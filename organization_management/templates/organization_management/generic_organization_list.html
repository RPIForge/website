{% load static %}
{% load js %}

{% block custom_styles %}
    <link rel="stylesheet" type="text/css" href="{% static 'forge/css/forms/list_organization.css' %}">
{% endblock custom_styles %}


<html>
	<head>
		<link rel="stylesheet" type="text/css" href="{% static 'forge/css/dyn/list.css' %}" />
		<script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
		<script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js" crossorigin="anonymous"></script>
		<script src="https://cdn.datatables.net/buttons/1.6.1/js/dataTables.buttons.min.js"></script>
		<script src="https://cdn.datatables.net/buttons/1.6.1/js/buttons.flash.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
		<script src="https://cdn.datatables.net/buttons/1.6.1/js/buttons.html5.min.js"></script>
		<script src="https://cdn.datatables.net/buttons/1.6.1/js/buttons.print.min.js"></script>
		<script src="//cdn.datatables.net/plug-ins/1.10.21/sorting/datetime-moment.js"></script>
		<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css" />
		<title>{{ page_title }}</title>
		{% include "forge/components/fonts.html" %} <!-- May not be necessary if this is only being loaded in frames. -->
	</head>

	<body>
		{% block organization_header %}
		<div id="org_choice">
			{% block org_select %}
			<label for='orgnization_select'>Select which Organization to view:</label>
			<select name="organization" id="orgnization_select">
				{% for org in org_data %}
					<option value="{{org}}">{{org}}</option>
				{% endfor %}
			</select>
			{% endblock org_select %}
		</div>
		{% endblock organization_header %}
		<table id="data" class="display">
			<thead>
			<tr>
			{% for header in table_headers %}
				<th>{{ header }}</th>
			{% endfor %}
			</tr>
			</thead>
			<tbody>
			</tbody>
		</table>


		<script>
			var dataTable = null;
			var org_data = {{org_data | js}}

			$(document).ready( function () {
					dataTable =$('#data').DataTable({
						"aLengthMenu": [[20, 50, 100, -1], [20, 50, 100, "All"]],
						"iDisplayLength": 20,
						"bFilter": false,
						"bPaginate": false,
                        "columnDefs": [
                            { "type": "datetime-moment", targets: 1 }
                        ],
						"language": {
					      "emptyTable": "No Users in Organization"
					    }
					});
					change_data(Object.keys(org_data)[0])
			} );

			$("select#orgnization_select").change(function(){
				change_data($(this).val())
			});

			
			function change_data(org_name){
				dataTable.clear()
				dataTable.rows.add( org_data[org_name] ).draw();
			}
		</script>
	</body>
</html>
